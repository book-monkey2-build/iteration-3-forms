{"version":3,"file":"book-form.component.js","sourceRoot":"","sources":["book-form.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input } from '@angular/core';\nimport { OnActivate, RouteSegment } from '@angular/router';\nimport { ControlGroup, ControlArray, FormBuilder } from '@angular/common';\nimport { Book } from '../domain/book'\nimport { BookStoreService } from '../services/books/book-store.service'\n\n@Component({\n  selector: 'book-form',\n  moduleId: module.id,\n  templateUrl: 'book-form.component.html',\n  providers: [BookStoreService]\n})\nexport class BookFormComponent implements OnActivate{\n  myForm: ControlGroup;\n  authorsControlArray: ControlArray;\n  thumbnailsControlArray: ControlArray;\n  isUpdatingBook: boolean;\n\n  constructor(private fb: FormBuilder, private bs: BookStoreService) {\n    this.isUpdatingBook = false;\n    this.initBook();\n  }\n\n  routerOnActivate(curr: RouteSegment):void {\n    var isbn = curr.getParam('isbn');\n    \n    if(isbn) {\n      this.isUpdatingBook = true;\n      let book = this.bs.getSingle(isbn);\n      this.initBook(book)\n    }\n  }\n\n  initBook(book?:Book){\n    if(!book) book = new Book('', '', [''], new Date(), '', 0, [{url:'', title: ''}], '');\n\n    this.myForm = this.fb.group({\n      title:       [book.title],\n      subtitle:    [book.subtitle],\n      isbn:        [book.isbn],\n      description: [book.description],\n      authors:      this.fb.array(book.authors),\n      thumbnails:   this.fb.array(\n        book.thumbnails.map(\n          t => this.fb.group({\n            url: this.fb.control(t.url),\n            title: this.fb.control(t.title)\n          })\n        )\n      ),\n      published: [book.published]\n    });\n\n    // this allows us to manipulate the form at runtime\n    this.authorsControlArray = <ControlArray>this.myForm.controls['authors'];\n    this.thumbnailsControlArray = <ControlArray>this.myForm.controls['thumbnails'];\n  }\n\n  addAuthorControl(){\n    this.authorsControlArray.push(this.fb.control(''));\n  }\n\n  addThumbnailControl(){\n    this.thumbnailsControlArray.push(this.fb.group({url: [''], title: ['']}));\n  }\n\n  submitForm(formData){\n    this.isUpdatingBook \n      ? this.bs.update(formData.value) \n      : this.bs.create(formData.value);\n  }\n}"]}